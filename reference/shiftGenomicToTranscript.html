<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Shift GRanges coordinates based on another GRanges
object — shiftTranscriptToGenomic • EpiTxDb</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Shift GRanges coordinates based on another GRanges
object — shiftTranscriptToGenomic" />
<meta property="og:description" content="shiftGenomicToTranscript shifts positions of a
GRanges
object based on coordinates of another GRanges object. The most common
application is to shift genomic coordinates to transcript coordinates, which
is reflected in the name. shiftTranscriptToGenomic implements the
reverse operation.
Matches are determined by
findOverlaps for
shiftGenomicToTranscript and by
findMatches for
shiftTranscriptToGenomic using the seqnames of the
subject and the names of tx." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiTxDb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/EpiTxDb.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/EpiTxDb-creation.html">EpiTxDb: creating an EpiTxDb object</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/FelixErnst/EpiTxDb/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Shift <code>GRanges</code> coordinates based on another <code>GRanges</code>
object</h1>
    <small class="dont-index">Source: <a href='https://github.com/FelixErnst/EpiTxDb/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/FelixErnst/EpiTxDb/blob/master/R/shiftGenomicToTranscript.R'><code>R/shiftGenomicToTranscript.R</code></a></small>
    <div class="hidden name"><code>shiftGenomicToTranscript.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>shiftGenomicToTranscript</code> shifts positions of a
<code><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></code>
object based on coordinates of another <code>GRanges</code> object. The most common
application is to shift genomic coordinates to transcript coordinates, which
is reflected in the name. <code>shiftTranscriptToGenomic</code> implements the
reverse operation.</p>
<p>Matches are determined by
<code><a href='https://rdrr.io/pkg/GenomicRanges/man/findOverlaps-methods.html'>findOverlaps</a></code> for
<code>shiftGenomicToTranscript</code> and by
<code><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-comparison.html'>findMatches</a></code> for
<code>shiftTranscriptToGenomic</code> using the <code>seqnames</code> of the
<code>subject</code> and the <code>names</code> of <code>tx</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>shiftTranscriptToGenomic</span><span class='op'>(</span><span class='va'>subject</span>, <span class='va'>tx</span><span class='op'>)</span>

<span class='fu'>shiftGenomicToTranscript</span><span class='op'>(</span><span class='va'>subject</span>, <span class='va'>tx</span><span class='op'>)</span>

<span class='co'># S4 method for GRanges,GRangesList</span>
<span class='fu'>shiftTranscriptToGenomic</span><span class='op'>(</span><span class='va'>subject</span>, <span class='va'>tx</span><span class='op'>)</span>

<span class='co'># S4 method for GRangesList,GRangesList</span>
<span class='fu'>shiftTranscriptToGenomic</span><span class='op'>(</span><span class='va'>subject</span>, <span class='va'>tx</span><span class='op'>)</span>

<span class='co'># S4 method for GRanges,GRangesList</span>
<span class='fu'>shiftGenomicToTranscript</span><span class='op'>(</span><span class='va'>subject</span>, <span class='va'>tx</span><span class='op'>)</span>

<span class='co'># S4 method for GRangesList,GRangesList</span>
<span class='fu'>shiftGenomicToTranscript</span><span class='op'>(</span><span class='va'>subject</span>, <span class='va'>tx</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>subject</th>
      <td><p>a <code><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></code> or
<code><a href='https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html'>GRangesList</a></code> object</p></td>
    </tr>
    <tr>
      <th>tx</th>
      <td><p>a named <code><a href='https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html'>GRangesList</a></code>
object.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></code> or
  <code><a href='https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html'>GRangesList</a></code> object depending
  on the type of <code>subject</code></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://bioconductor.org/packages/GenomicRanges'>GenomicRanges</a></span><span class='op'>)</span>
<span class='co'># Construct some example data</span>
<span class='va'>subject1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span><span class='st'>"chr1"</span>, <span class='fu'>IRanges</span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>6</span><span class='op'>)</span>,
                    strand <span class='op'>=</span> <span class='st'>"+"</span><span class='op'>)</span>
<span class='va'>subject2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span><span class='st'>"chr1"</span>, <span class='fu'>IRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>17</span>,<span class='fl'>23</span><span class='op'>)</span>, width<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>,
                    strand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"+"</span>,<span class='st'>"-"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>subject3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span><span class='st'>"chr2"</span>, <span class='fu'>IRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>51</span>, <span class='fl'>54</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>53</span>, <span class='fl'>59</span><span class='op'>)</span><span class='op'>)</span>,
                    strand <span class='op'>=</span> <span class='st'>"-"</span><span class='op'>)</span>
<span class='va'>subject</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html'>GRangesList</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='va'>subject1</span>, b<span class='op'>=</span><span class='va'>subject2</span>, c<span class='op'>=</span><span class='va'>subject3</span><span class='op'>)</span>
<span class='va'>tx1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span><span class='st'>"chr1"</span>, <span class='fu'>IRanges</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>40</span><span class='op'>)</span>,
               strand<span class='op'>=</span><span class='st'>"+"</span><span class='op'>)</span>
<span class='va'>tx2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span><span class='st'>"chr1"</span>, <span class='fu'>IRanges</span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>30</span><span class='op'>)</span>,
               strand<span class='op'>=</span><span class='st'>"+"</span><span class='op'>)</span>
<span class='va'>tx3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span><span class='st'>"chr2"</span>, <span class='fu'>IRanges</span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>60</span><span class='op'>)</span>,
               strand<span class='op'>=</span><span class='st'>"-"</span><span class='op'>)</span>
<span class='va'>tx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html'>GRangesList</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='va'>tx1</span>, b<span class='op'>=</span><span class='va'>tx2</span>, c<span class='op'>=</span><span class='va'>tx3</span><span class='op'>)</span>

<span class='co'># shift to transcript coordinates. Since the third subject does not have</span>
<span class='co'># a match in tx it is dropped with a warning</span>
<span class='va'>shifted_grl</span> <span class='op'>&lt;-</span> <span class='fu'>shiftGenomicToTranscript</span><span class='op'>(</span><span class='va'>subject</span>,<span class='va'>tx</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Dropping elements of 'subject' which could not be repositioned.</span></div><div class='input'>
<span class='co'># ... and back</span>
<span class='va'>shifted_grl2</span> <span class='op'>&lt;-</span> <span class='fu'>shiftTranscriptToGenomic</span><span class='op'>(</span><span class='va'>shifted_grl</span>,<span class='va'>tx</span><span class='op'>)</span>

<span class='co'># comparison of ranges work. However the seqlevels differ</span>
<span class='fu'>ranges</span><span class='op'>(</span><span class='va'>shifted_grl2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fu'>ranges</span><span class='op'>(</span><span class='va'>subject</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: longer argument not a multiple of length of shorter</span></div><div class='output co'>#&gt; LogicalList of length 4
#&gt; [["a"]] TRUE
#&gt; [["a"]] FALSE FALSE
#&gt; [["b"]] FALSE FALSE
#&gt; [["c"]] FALSE FALSE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Felix G.M. Ernst.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


