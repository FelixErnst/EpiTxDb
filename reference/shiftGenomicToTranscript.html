<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Shift GRanges coordinates based on another GRanges
object — shiftTranscriptToGenomic • EpiTxDb</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Shift GRanges coordinates based on another GRanges
object — shiftTranscriptToGenomic"><meta property="og:description" content="shiftGenomicToTranscript shifts positions of a
GRanges
object based on coordinates of another GRanges object. The most common
application is to shift genomic coordinates to transcript coordinates, which
is reflected in the name. shiftTranscriptToGenomic implements the
reverse operation.
Matches are determined by
findOverlaps for
shiftGenomicToTranscript and by
findMatches for
shiftTranscriptToGenomic using the seqnames of the
subject and the names of tx."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiTxDb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/EpiTxDb.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/EpiTxDb-creation.html">EpiTxDb: creating an EpiTxDb object</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/FelixErnst/EpiTxDb/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Shift <code>GRanges</code> coordinates based on another <code>GRanges</code>
object</h1>
    <small class="dont-index">Source: <a href="https://github.com/FelixErnst/EpiTxDb/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/FelixErnst/EpiTxDb/blob/HEAD/R/shiftGenomicToTranscript.R" class="external-link"><code>R/shiftGenomicToTranscript.R</code></a></small>
    <div class="hidden name"><code>shiftGenomicToTranscript.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>shiftGenomicToTranscript</code> shifts positions of a
<code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></code>
object based on coordinates of another <code>GRanges</code> object. The most common
application is to shift genomic coordinates to transcript coordinates, which
is reflected in the name. <code>shiftTranscriptToGenomic</code> implements the
reverse operation.</p>
<p>Matches are determined by
<code><a href="https://rdrr.io/pkg/GenomicRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps</a></code> for
<code>shiftGenomicToTranscript</code> and by
<code><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-comparison.html" class="external-link">findMatches</a></code> for
<code>shiftTranscriptToGenomic</code> using the <code>seqnames</code> of the
<code>subject</code> and the <code>names</code> of <code>tx</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">shiftTranscriptToGenomic</span><span class="op">(</span><span class="va">subject</span>, <span class="va">tx</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">shiftGenomicToTranscript</span><span class="op">(</span><span class="va">subject</span>, <span class="va">tx</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for GRanges,GRangesList</span></span>
<span><span class="fu">shiftTranscriptToGenomic</span><span class="op">(</span><span class="va">subject</span>, <span class="va">tx</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for GRangesList,GRangesList</span></span>
<span><span class="fu">shiftTranscriptToGenomic</span><span class="op">(</span><span class="va">subject</span>, <span class="va">tx</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for GRanges,GRangesList</span></span>
<span><span class="fu">shiftGenomicToTranscript</span><span class="op">(</span><span class="va">subject</span>, <span class="va">tx</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for GRangesList,GRangesList</span></span>
<span><span class="fu">shiftGenomicToTranscript</span><span class="op">(</span><span class="va">subject</span>, <span class="va">tx</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>subject</dt>
<dd><p>a <code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></code> or
<code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html" class="external-link">GRangesList</a></code> object</p></dd>


<dt>tx</dt>
<dd><p>a named <code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html" class="external-link">GRangesList</a></code>
object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></code> or</p>
<p></p>
<p><code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html" class="external-link">GRangesList</a></code> object depending
  on the type of <code>subject</code></p>


    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicRanges" class="external-link">GenomicRanges</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Construct some example data</span></span></span>
<span class="r-in"><span><span class="va">subject1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    strand <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">subject2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>,<span class="fl">23</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    strand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">subject3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr2"</span>, <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51</span>, <span class="fl">54</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">53</span>, <span class="fl">59</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    strand <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html" class="external-link">GRangesList</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">subject1</span>, b<span class="op">=</span><span class="va">subject2</span>, c<span class="op">=</span><span class="va">subject3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">40</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               strand<span class="op">=</span><span class="st">"+"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               strand<span class="op">=</span><span class="st">"+"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tx3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr2"</span>, <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">60</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               strand<span class="op">=</span><span class="st">"-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html" class="external-link">GRangesList</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">tx1</span>, b<span class="op">=</span><span class="va">tx2</span>, c<span class="op">=</span><span class="va">tx3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># shift to transcript coordinates. Since the third subject does not have</span></span></span>
<span class="r-in"><span><span class="co"># a match in tx it is dropped with a warning</span></span></span>
<span class="r-in"><span><span class="va">shifted_grl</span> <span class="op">&lt;-</span> <span class="fu">shiftGenomicToTranscript</span><span class="op">(</span><span class="va">subject</span>,<span class="va">tx</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Dropping elements of 'subject' which could not be repositioned.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... and back</span></span></span>
<span class="r-in"><span><span class="va">shifted_grl2</span> <span class="op">&lt;-</span> <span class="fu">shiftTranscriptToGenomic</span><span class="op">(</span><span class="va">shifted_grl</span>,<span class="va">tx</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># comparison of ranges work. However the seqlevels differ</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/range-squeezers.html" class="external-link">ranges</a></span><span class="op">(</span><span class="va">shifted_grl2</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/range-squeezers.html" class="external-link">ranges</a></span><span class="op">(</span><span class="va">subject</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>longer argument not a multiple of length of shorter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LogicalList of length 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [["a"]] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [["a"]] FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [["b"]] FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [["c"]] FALSE FALSE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Felix G.M. Ernst.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

